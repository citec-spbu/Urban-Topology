# –°–µ—Ä–≤–∏—Å –ø–æ –∞–Ω–∞–ª–∏–∑—É –≥–æ—Ä–æ–¥—Å–∫–æ–π —Ç–æ–ø–æ–ª–æ–≥–∏–∏

–ü—Ä–æ–µ–∫—Ç –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ —Ç–æ–ø–æ–ª–æ–≥–∏–∏ –≥–æ—Ä–æ–¥–æ–≤ –∏ –≥–æ—Ä–æ–¥—Å–∫–∏—Ö —Å–µ—Ç–µ–π.

## üìã –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ
- [–ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è](#–ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–µ-–¥–µ–π—Å—Ç–≤–∏—è)
- [–ó–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è](#–∑–∞–ø—É—Å–∫-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è)
- [–í—ã–∫–ª—é—á–µ–Ω–∏–µ —Å–µ—Ä–≤–µ—Ä–∞](#–≤—ã–∫–ª—é—á–µ–Ω–∏–µ-—Å–µ—Ä–≤–µ—Ä–∞)
- [–¢–µ—Å—Ç—ã](#—Ç–µ—Å—Ç—ã)
- [–ê–Ω–∞–ª–∏–∑ –≥—Ä–∞—Ñ–æ–≤](#–∞–Ω–∞–ª–∏–∑-–≥—Ä–∞—Ñ–æ–≤)
- [–ì—Ä–∞—Ñ –ø—Ä–∏–¥–æ–º–æ–≤—ã—Ö –ø—Ä–æ–µ–∑–¥–æ–≤](#–≥—Ä–∞—Ñ-–ø—Ä–∏–¥–æ–º–æ–≤—ã—Ö-–ø—Ä–æ–µ–∑–¥–æ–≤)
- [–≠–∫—Å–ø–æ—Ä—Ç CSV](#—ç–∫—Å–ø–æ—Ä—Ç-csv)
- [–£—Ç–∏–ª–∏—Ç—ã –≤ –∫–∞—Ç–∞–ª–æ–≥–µ `tools`](#—É—Ç–∏–ª–∏—Ç—ã-–≤-–∫–∞—Ç–∞–ª–æ–≥–µ-tools)

## <a id="–ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–µ-–¥–µ–π—Å—Ç–≤–∏—è">–ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è</a>

1. –°–∫–∞—á–∞–π—Ç–µ PBF-—Ñ–∞–π–ª—ã –∏—Å—Å–ª–µ–¥—É–µ–º—ã—Ö –≥–æ—Ä–æ–¥–æ–≤ –∏ –ø–æ–º–µ—Å—Ç–∏—Ç–µ –∏—Ö –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é `/cities_pbf/` –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞ (—Å–æ–∑–¥–∞–π—Ç–µ –µ—ë, –µ—Å–ª–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç).
2. –ù–∞–∑–≤–∞–Ω–∏—è —Ñ–∞–π–ª–æ–≤ –¥–æ–ª–∂–Ω—ã –∏–º–µ—Ç—å –≤–∏–¥: `{–ù–∞–∑–≤–∞–Ω–∏–µ –≥–æ—Ä–æ–¥–∞ —Å –±–æ–ª—å—à–æ–π –±—É–∫–≤—ã}.pbf`. –ü—Ä–∏–º–µ—Ä: `–ú–æ—Å–∫–≤–∞.pbf`.
3. –î–ª—è —Å–∫–∞—á–∏–≤–∞–Ω–∏—è –≥–æ—Ç–æ–≤—ã—Ö —Ñ–∞–π–ª–æ–≤ –º–æ–∂–Ω–æ –≤–æ—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è [https://extract.bbbike.org/](https://extract.bbbike.org/) –∏–ª–∏ —Å–∫—Ä–∏–ø—Ç–æ–º `tools/osm_fetch.py` (—Ñ—É–Ω–∫—Ü–∏—è `download_city`).

## <a id="–∑–∞–ø—É—Å–∫-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è">–ó–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è</a>
–ü–µ—Ä–µ–¥ –∑–∞–ø—É—Å–∫–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –∑–∞–¥–∞–π—Ç–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è (–º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ª–æ–∫–∞–ª—å–Ω—ã–π `.env`, –∫–æ—Ç–æ—Ä—ã–π –Ω–µ –ø–æ–ø–∞–¥–∞–µ—Ç –≤ Git, –∏–ª–∏ —Ñ–∞–π–ª `secrets/*.env` —Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–º–∏ –ø—Ä–∞–≤–∞–º–∏ –¥–æ—Å—Ç—É–ø–∞):

- `DADATA_TOKEN` ‚Äî –¥–µ–π—Å—Ç–≤—É—é—â–∏–π API-—Ç–æ–∫–µ–Ω DaData. –¢–æ–∫–µ–Ω –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è –≤–Ω—É—Ç—Ä—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ (`webserver`) –∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –º–æ–¥—É–ª–µ–º `street_name_parser`. –ü—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π —Å–µ—Ä–≤–∏—Å –∑–∞–≤–µ—Ä—à–∞–µ—Ç —Ä–∞–±–æ—Ç—É —Å –æ—à–∏–±–∫–æ–π.

#### –ö–∞–∫ –ø–æ–ª—É—á–∏—Ç—å `DADATA_TOKEN`

1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ https://dadata.ru/profile/#info –∏ —Å–æ–∑–¥–∞–π—Ç–µ –±–µ—Å–ø–ª–∞—Ç–Ω—ã–π –∞–∫–∫–∞—É–Ω—Ç (–ø–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ –ø–æ—á—Ç—É/—Ç–µ–ª–µ—Ñ–æ–Ω, –µ—Å–ª–∏ –ø–æ—Ç—Ä–µ–±—É–µ—Ç—Å—è).
2. –í –ª–∏—á–Ω–æ–º –∫–∞–±–∏–Ω–µ—Ç–µ –æ—Ç–∫—Ä–æ–π—Ç–µ —Ä–∞–∑–¥–µ–ª **API-–∫–ª—é—á–∏** –∏ —Å–∫–æ–ø–∏—Ä—É–π—Ç–µ –∑–Ω–∞—á–µ–Ω–∏–µ –ø–æ–ª—è ¬´–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π API-–∫–ª—é—á¬ª.
3. –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ –∫–ª—é—á –≤ –ª–æ–∫–∞–ª—å–Ω–æ–º `.env` –∏–ª–∏ —Ñ–∞–π–ª–µ `secrets/*.env` –∫–∞–∫ `DADATA_TOKEN=<–≤–∞—à_–∫–ª—é—á>` –∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã (`docker compose up --build`), —á—Ç–æ–±—ã –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è –ø–æ–ø–∞–ª–∞ –≤ backend.

–í production-—Å—Ä–µ–¥–µ —Ö—Ä–∞–Ω–∏—Ç–µ –∑–Ω–∞—á–µ–Ω–∏—è `POSTGRES_USER`, `POSTGRES_PASSWORD`, `DATABASE_URL`, `DADATA_TOKEN` –∏ –¥—Ä—É–≥–∏—Ö —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –≤ —Å–µ–∫—Ä–µ—Ç–Ω–æ–º —Ö—Ä–∞–Ω–∏–ª–∏—â–µ –∏–ª–∏ —Ñ–∞–π–ª–∞—Ö `secrets/*.env`, –∫–æ—Ç–æ—Ä—ã–µ –¥–æ—Å—Ç—É–ø–Ω—ã —Ç–æ–ª—å–∫–æ —Å–∏—Å—Ç–µ–º–µ –¥–µ–ø–ª–æ—è.

---

–î–ª—è –∑–∞–ø—É—Å–∫–∞ —Å–µ—Ä–≤–µ—Ä–Ω–æ–π —á–∞—Å—Ç–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –≤—ã–ø–æ–ª–Ω–∏—Ç—å –∏–∑ –æ—Å–Ω–æ–≤–Ω–æ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –ø—Ä–æ–µ–∫—Ç–∞ –∫–æ–º–∞–Ω–¥—É:

    docker compose up --build

–ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∫–æ–º–∞–Ω–¥—ã, –ø–æ –æ–∫–æ–Ω—á–∞–Ω–∏–∏ —Å–±–æ—Ä–∫–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞, –¥–æ—Å—Ç—É–ø –∫ —Å–∞–π—Ç—É –∏ —Å–µ—Ä–≤–µ—Ä—É –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –º–æ–∂–Ω–æ –ø–æ–ª—É—á–∏—Ç—å –ø–æ —Å–ª–µ–¥—É—é—â–∏–º —Å—Å—ã–ª–∫–∞–º:

| –í–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ | –°–µ—Ä–≤–µ—Ä –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö |
| ----------- | ----------- |
| [http://localhost:4200/](http://localhost:4200/)    | [http://localhost:8901/docs/](http://localhost:8901/docs/)    |

## <a id="–≤—ã–∫–ª—é—á–µ–Ω–∏–µ-—Å–µ—Ä–≤–µ—Ä–∞">–í—ã–∫–ª—é—á–µ–Ω–∏–µ —Å–µ—Ä–≤–µ—Ä–∞</a>
–î–ª—è —Ç–æ–≥–æ —á—Ç–æ–±—ã –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –∑–∞–≤–µ—Ä—à–∏—Ç—å —Ä–∞–±–æ—Ç—É —Å–µ—Ä–≤–µ—Ä–∞ –≤ –∫–æ–Ω—Å–æ–ª–∏ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ –∫–æ–º–∞–Ω–¥—É:

     docker compose down

## <a id="—Ç–µ—Å—Ç—ã">–¢–µ—Å—Ç—ã</a>
–í—Å–µ —Ç–µ—Å—Ç—ã –Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤ –∫–∞—Ç–∞–ª–æ–≥–µ `api/backend/tests`. –ü–µ—Ä–µ–¥ –∑–∞–ø—É—Å–∫–æ–º –ø–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –ø–∞–ø–∫—É `api` –∏ –∞–∫—Ç–∏–≤–∏—Ä—É–π—Ç–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ (`source venv/bin/activate`), –µ—Å–ª–∏ –æ–Ω–æ –µ—â—ë –Ω–µ –∞–∫—Ç–∏–≤–Ω–æ.

- –ü—Ä–æ–≥–Ω–∞—Ç—å —É–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –Ω–∞–±–æ—Ä —Ç–µ—Å—Ç–æ–≤ —Å –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ–º –ø–æ–∫—Ä—ã—Ç–∏—è –≤ —Ç–µ—Ä–º–∏–Ω–∞–ª–µ:

    ```venv/bin/python -m pytest --cov=backend --cov-report=term-missing```

- –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å HTML-–æ—Ç—á—ë—Ç –æ —Ç–µ—Å—Ç–∞—Ö –∏ –ø–æ–∫—Ä—ã—Ç–∏–∏:

  ```venv/bin/python -m pytest backend/tests --cov=backend --cov-report=html --html=report.html --self-contained-html```

  –ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø–æ—è–≤—è—Ç—Å—è —Ñ–∞–π–ª—ã `report.html` (—Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–æ–≤) –∏ –∫–∞—Ç–∞–ª–æ–≥ `htmlcov/index.html` (–¥–µ—Ç–∞–ª—å–Ω–æ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ). –ò—Ö –º–æ–∂–Ω–æ –æ—Ç–∫—Ä—ã—Ç—å –≤ –±—Ä–∞—É–∑–µ—Ä–µ –¥–ª—è –Ω–∞–≥–ª—è–¥–Ω–æ–≥–æ –ø—Ä–æ—Å–º–æ—Ç—Ä–∞.

 ## <a id="–∞–Ω–∞–ª–∏–∑-–≥—Ä–∞—Ñ–æ–≤">–ê–Ω–∞–ª–∏–∑ –≥—Ä–∞—Ñ–æ–≤</a>
 –í –∫–∞—Ç–∞–ª–æ–≥–µ `/analytics` –ª–µ–∂–∞—Ç –Ω–æ—É—Ç–±—É–∫–∏, –∫–æ—Ç–æ—Ä—ã–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¥–ª—è –ø–æ–∏—Å–∫–∞ —Å—Ç–µ–ø–µ–Ω–Ω–æ–≥–æ –∑–∞–∫–æ–Ω–∞ (degrees.ipynb), –¥–ª—è –≤—ã—á–∏—Å–ª–µ–Ω–∏—è –º–µ—Ä —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω–æ—Å—Ç–∏ (centrality.ipynb) –∏ betweenness'–∞.

–î–ª—è —Ä–∞–±–æ—Ç—ã —Å –¥–∞–Ω–Ω—ã–º–∏ –Ω–æ—É—Ç–±—É–∫–∞–º–∏ —Ç—Ä–µ–±—É–µ—Ç—Å—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ _graph-tool_. –ù–∞ –º–æ–º–µ–Ω—Ç –Ω–∞–ø–∏—Å–∞–Ω–∏—è README —Å–∞–º—ã–π —É–¥–æ–±–Ω—ã–π —Å–ø–æ—Å–æ–± –µ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è - –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã. –í –∫–∞—Ç–∞–ª–æ–≥–µ —Ç–∞–∫–∂–µ –ª–µ–∂–∏—Ç Dockerfile –¥–ª—è —Ç–æ–≥–æ, —á—Ç–æ–±—ã –¥–∞–Ω–Ω—ã–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –º–æ–∂–Ω–æ –±—ã–ª–æ –ø–æ–¥–Ω—è—Ç—å.

–ù–∞ –≤—Ö–æ–¥ –Ω–æ—É—Ç–±—É–∫–∏ –ø—Ä–∏–Ω–∏–º–∞—é—Ç JSON-—Ñ–∞–π–ª, –∫–æ—Ç–æ—Ä—ã–µ –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç –≤ –∫–∞—á–µ—Å—Ç–≤–µ –æ—Ç–≤–µ—Ç–∞ –º–µ—Ç–æ–¥—ã `/api/city/graph/region/` –∏ `/api/city/graph/bbox/`.

 ## <a id="–≥—Ä–∞—Ñ-–ø—Ä–∏–¥–æ–º–æ–≤—ã—Ö-–ø—Ä–æ–µ–∑–¥–æ–≤">–ì—Ä–∞—Ñ –ø—Ä–∏–¥–æ–º–æ–≤—ã—Ö –ø—Ä–æ–µ–∑–¥–æ–≤</a>
 –ü—Ä–∏ –∏–º–ø–æ—Ä—Ç–µ –≥–æ—Ä–æ–¥–∞ –∏–∑ PBF —Ç–µ–ø–µ—Ä—å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ —Å—Ç—Ä–æ–∏—Ç—Å—è –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–π –≥—Ä–∞—Ñ –ø–æ–¥—ä–µ–∑–¥–Ω—ã—Ö/–¥–≤–æ—Ä–æ–≤—ã—Ö –¥–æ—Ä–æ–≥. –ù–æ–≤—ã–µ —Ç–∞–±–ª–∏—Ü—ã `AccessNodes` –∏ `AccessEdges` —Å–æ–¥–µ—Ä–∂–∞—Ç:

- **–£–∑–ª—ã** (`AccessNodes`):
  - `node_type = 'building'` ‚Äî –æ—Ç–¥–µ–ª—å–Ω–æ —Å—Ç–æ—è—â–∏–µ –∑–¥–∞–Ω–∏—è (—Ü–µ–Ω—Ç—Ä–æ–∏–¥—ã –∫–æ–Ω—Ç—É—Ä–æ–≤ `building=*`).
  - `node_type = 'intersection'` ‚Äî –ø–µ—Ä–µ–∫—Ä—ë—Å—Ç–∫–∏ –∏ —Ä–∞–∑–≤–∏–ª–∫–∏ –º–∞–ª—ã—Ö –¥–æ—Ä–æ–≥ (`service`, `residential`, `living_street`, `unclassified`, `track`, `road`).
- **–†—ë–±—Ä–∞** (`AccessEdges`):
  - `road_type` —Ä–∞–≤–µ–Ω –∏—Å—Ö–æ–¥–Ω–æ–º—É `highway` (–∏–ª–∏ `building_link` –¥–ª—è —Å–∏–Ω—Ç–µ—Ç–∏—á–µ—Å–∫–æ–≥–æ —Ä–µ–±—Ä–∞ ¬´–∑–¥–∞–Ω–∏–µ ‚Üí –¥–æ—Ä–æ–≥–∞¬ª).
  - `is_building_link = true` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –≤—ã–¥–µ–ª–µ–Ω–∏—è –ø–æ–¥—ä–µ–∑–¥–æ–≤.

–≠—Ç–∏ —Ç–∞–±–ª–∏—Ü—ã –∑–∞–ø–æ–ª–Ω—è—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤–æ –≤—Ä–µ–º—è `import_city_graph`. –í –æ—Ç–≤–µ—Ç–∞—Ö `/api/city/graph/*` –¥–æ–±–∞–≤–ª–µ–Ω—ã –Ω–æ–≤—ã–µ CSV-–ø–æ–ª—è:

- `access_nodes_csv` —Å –∫–æ–ª–æ–Ω–∫–∞–º–∏ `id,node_type,longitude,latitude,source_type,source_id,name`.
- `access_edges_csv` —Å –∫–æ–ª–æ–Ω–∫–∞–º–∏ `id,source,target,source_way_id,road_type,length_m,is_building_link,name`.

–§—Ä–æ–Ω—Ç–µ–Ω–¥ (–≤–∏–¥–∂–µ—Ç ¬´–î–æ—Ä–æ–≥–∏¬ª) –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç –Ω–æ–≤—ã–π —Å–ª–æ–π –ø–æ–≤–µ—Ä—Ö –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –≥—Ä–∞—Ñ–∞: –∑–¥–∞–Ω–∏—è –ø–æ–∫–∞–∑–∞–Ω—ã –∑–µ–ª—ë–Ω—ã–º–∏ –º–∞—Ä–∫–µ—Ä–∞–º–∏, –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ —É–∑–ª—ã ‚Äî –æ—Ä–∞–Ω–∂–µ–≤—ã–º–∏, –ø–æ–¥—ä–µ–∑–¥–Ω—ã–µ —Ä—ë–±—Ä–∞ ‚Äî –≤—ã–¥–µ–ª–µ–Ω–Ω—ã–º–∏ –ª–∏–Ω–∏—è–º–∏.

 ## <a id="—ç–∫—Å–ø–æ—Ä—Ç-csv">–≠–∫—Å–ø–æ—Ä—Ç CSV</a>
 –î–ª—è —Å–∫–∞—á–∏–≤–∞–Ω–∏—è –ø–æ–ª–Ω–æ–≥–æ –Ω–∞–±–æ—Ä–∞ CSV (—É–∑–ª—ã, —Ä—ë–±—Ä–∞, —Å–≤–æ–π—Å—Ç–≤–∞ –∏ –º–µ—Ç—Ä–∏–∫–∏) –¥–æ–±–∞–≤–ª–µ–Ω —ç–Ω–¥–ø–æ–∏–Ω—Ç `POST /api/city/graph/region/export/`. –û–Ω –ø—Ä–∏–Ω–∏–º–∞–µ—Ç —Ç–æ—Ç –∂–µ –Ω–∞–±–æ—Ä –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤, —á—Ç–æ –∏ `/api/city/graph/region/`, –∞ –≤ –æ—Ç–≤–µ—Ç –æ—Ç–¥–∞—ë—Ç ZIP-–∞—Ä—Ö–∏–≤ —Å–æ —Å–ª–µ–¥—É—é—â–∏–º–∏ —Ñ–∞–π–ª–∞–º–∏:

- `nodes.csv` ‚Äî –æ–±—ä–µ–¥–∏–Ω—ë–Ω–Ω—ã–µ —É–∑–ª—ã –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –∏ –ø—Ä–∏–¥–æ–º–æ–≤–æ–≥–æ –≥—Ä–∞—Ñ–æ–≤ —Å –ø—Ä–∏–∑–Ω–∞–∫–æ–º —Å–ª–æ—è (`layer=base|access`).
- `edges.csv` ‚Äî –æ–±—ä–µ–¥–∏–Ω—ë–Ω–Ω—ã–µ —Ä—ë–±—Ä–∞ —Å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–º–∏ –∫–æ–ª–æ–Ω–∫–∞–º–∏ (`road_type`, `length_m`, `is_building_link`, `layer`).
- `points_properties.csv`, `ways_properties.csv`, `metrics.csv` ‚Äî –∏—Å—Ö–æ–¥–Ω—ã–µ —Ñ–∞–π–ª—ã –∏–∑ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –æ—Ç–≤–µ—Ç–∞.

–§–∞–π–ª –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–ª—è –¥–∞–ª—å–Ω–µ–π—à–µ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ –∏–ª–∏ —Å—Ç–æ—Ä–æ–Ω–Ω–∏—Ö –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–π –±–µ–∑ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ —Ä—É—á–Ω–æ–≥–æ —Å–∫–ª–µ–∏–≤–∞–Ω–∏—è —Å–ª–æ—ë–≤.

 ## <a id="—É—Ç–∏–ª–∏—Ç—ã-–≤-–∫–∞—Ç–∞–ª–æ–≥–µ-tools">–£—Ç–∏–ª–∏—Ç—ã –≤ –∫–∞—Ç–∞–ª–æ–≥–µ `tools`</a>
–í –ø–∞–ø–∫–µ `tools/` –ª–µ–∂–∞—Ç –Ω–µ–±–æ–ª—å—à–∏–µ CLI-—Å–∫—Ä–∏–ø—Ç—ã, –∫–æ—Ç–æ—Ä—ã–µ –ø–æ–º–æ–≥–∞—é—Ç –ø—Ä–æ–≤–µ—Ä—è—Ç—å –∏ –≤–∏–∑—É–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –≥—Ä–∞—Ñ—ã –≤–Ω–µ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è:

- `export_buildings_csv.py` ‚Äî –ø–∞—Ä—Å–∏—Ç `.pbf` –Ω–∞–ø—Ä—è–º—É—é –∏ –≤—ã–≥—Ä—É–∂–∞–µ—Ç CSV —Å–æ –≤—Å–µ–º–∏ –∑–¥–∞–Ω–∏—è–º–∏ (`source_id`, –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã, –∏–º—è), –∫–æ—Ç–æ—Ä—ã–µ –æ–±–Ω–∞—Ä—É–∂–∏–≤–∞–µ—Ç –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –ø—Ä–∏–¥–æ–º–æ–≤–æ–≥–æ –≥—Ä–∞—Ñ–∞.
- `visualize_buildings_map.py` ‚Äî —Å—Ç—Ä–æ–∏—Ç –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—É—é –∫–∞—Ä—Ç—É (Folium/Leaflet) –ø–æ –∑–¥–∞–Ω–∏—è–º –∏–∑ `.pbf`; –º–æ–∂–Ω–æ –æ–≥—Ä–∞–Ω–∏—á–∏—Ç—å —á–∏—Å–ª–æ —Ç–æ—á–µ–∫ —á–µ—Ä–µ–∑ `--limit`, —Ä–µ–∑—É–ª—å—Ç–∞—Ç —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ HTML.
- `visualize_export.py` ‚Äî –ø—Ä–∏–Ω–∏–º–∞–µ—Ç —Ä–∞—Å–ø–∞–∫–æ–≤–∞–Ω–Ω—É—é –ø–∞–ø–∫—É –∏–∑ ZIP-—ç–∫—Å–ø–æ—Ä—Ç–∞ (`nodes.csv`, `edges.csv`) –∏ —Ä–µ–Ω–¥–µ—Ä–∏—Ç –æ–±–∞ —Å–ª–æ—è (–æ—Å–Ω–æ–≤–Ω–æ–π –∏ –ø—Ä–∏–¥–æ–º–æ–≤–æ–π) –Ω–∞ –∫–∞—Ä—Ç–µ —Å –ø–µ—Ä–µ–∫–ª—é—á–∞–µ–º—ã–º–∏ —Å–ª–æ—è–º–∏.
- `inspect_cache.py` ‚Äî –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç JSON-—Ñ–∞–π–ª—ã –∫—ç—à–∞ (`data/caches/*.json`), –≤—ã–≤–æ–¥–∏—Ç —Å–≤–æ–¥–Ω—É—é —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –∏ –ø–æ–¥—Å–≤–µ—á–∏–≤–∞–µ—Ç —É–∑–ª—ã –±–µ–∑ –º–µ—Ç—Ä–∏–∫ –∏–ª–∏ —Ä—ë–±—Ä–∞ —Å –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏–º–∏ –≤–µ—Ä—à–∏–Ω–∞–º–∏.
- `osm_fetch.py` ‚Äî —Å–∫–∞—á–∏–≤–∞–µ—Ç OSM-–≤—ã–≥—Ä—É–∑–∫—É –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é –≥–æ—Ä–æ–¥–∞ –∏–ª–∏ –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω–æ–º—É bbox —á–µ—Ä–µ–∑ Overpass; —É–¥–æ–±–Ω—ã–π —Å–ø–æ—Å–æ–± –±—ã—Å—Ç—Ä–æ –ø–æ–ø–æ–ª–Ω–∏—Ç—å `cities_pbf/`.

–ö–∞–∂–¥—ã–π —Å–∫—Ä–∏–ø—Ç –º–æ–∂–Ω–æ –∑–∞–ø—É—Å—Ç–∏—Ç—å –Ω–∞–ø—Ä—è–º—É—é –∏–∑ –∫–æ—Ä–Ω—è –ø—Ä–æ–µ–∫—Ç–∞, –Ω–∞–ø—Ä–∏–º–µ—Ä:

```bash
python tools/visualize_export.py city-73-–æ–∫—Ç—è–±—Ä—å—Å–∫–∏–π --output graph.html
python tools/inspect_cache.py api/backend/data/caches/73_1_2.json
```

–î–ª—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ —Ç—Ä–µ–±—É–µ—Ç—Å—è —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–π `folium` (—É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ `pip install folium`, –µ—Å–ª–∏ –µ—â—ë –Ω–µ —Å—Ç–∞–≤–∏–ª–∏).
